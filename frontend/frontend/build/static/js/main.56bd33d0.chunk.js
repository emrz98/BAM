(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{45:function(e,t,n){},46:function(e,t,n){},47:function(e,t,n){},48:function(e,t,n){},49:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n.n(r),a=n(17),s=n.n(a),u=n(3),i=n(2),o=n.n(i),l=n(5),j=n(18),d=n(19),h=n(6),b=n.n(h),f=function(){function e(){Object(j.a)(this,e)}return Object(d.a)(e,null,[{key:"authenticate",value:function(){var t=Object(l.a)(o.a.mark((function t(n,r,c){var a,s;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a={username:n,password:r},t.next=3,b.a.post(e.url+"login/",a).then((function(e){return e.data})).catch((function(e){return alert(e)}));case 3:400===(s=t.sent)?alert("Invalid credentials"):c(s.token);case 5:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()},{key:"createCustomer",value:function(){var t=Object(l.a)(o.a.mark((function t(n,r,c,a){var s;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s={name:n,date_of_birth:c,email:r},t.next=3,b.a.post(e.url+"customer/",s,{headers:{Authorization:"Token ".concat(a)}}).then((function(e){return e.data})).catch((function(e){return alert(e)}));case 3:400===t.sent?alert("Creacion incorrecta"):(alert("Cliente creado"),window.location.reload());case 5:case"end":return t.stop()}}),t)})));return function(e,n,r,c){return t.apply(this,arguments)}}()},{key:"updateCustomerStatus",value:function(){var t=Object(l.a)(o.a.mark((function t(n,r,c){var a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a={status:r},t.next=3,b.a.post(e.url+"customer/"+n+"/history/",a,{headers:{Authorization:"Token ".concat(c)}}).then((function(e){return e.data})).catch((function(e){return alert(e)}));case 3:void 0===t.sent?alert("Para actualizar el estatus debes escoger uno diferente"):(alert("Status Actualizado"),window.location.reload());case 5:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()},{key:"getAllCustomerNames",value:function(){var t=Object(l.a)(o.a.mark((function t(n,r){var c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,b.a.get(e.url+"customer/",{headers:{Authorization:"Token ".concat(n)}}).then((function(e){return e.data})).catch((function(e){return alert(e)}));case 2:return c=t.sent,t.abrupt("return",c);case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"getCustomerHistory",value:function(){var t=Object(l.a)(o.a.mark((function t(n,r){var c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,b.a.get(e.url+"customer/"+n+"/history/",{headers:{Authorization:"Token ".concat(r)}}).then((function(e){return e.data})).catch((function(e){return alert(e)}));case 2:return c=t.sent,t.abrupt("return",c);case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}]),e}();f.url="http://127.0.0.1:8000/api/";var p=f,m=n(0);var O=function(e){var t,n=e.currentHistory.length>0?(t=e.currentHistory,t.sort((function(e,t){return new Date(t.date)-new Date(e.date)})),t[t.length-1]).status:null,c=Object(r.useState)(n),a=Object(u.a)(c,2),s=a[0],i=a[1];return Object.keys(e.currentDetail).length>0?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)("div",{children:[Object(m.jsx)("h3",{children:"Detalles"}),Object(m.jsxs)("p",{children:["Nombre: ",e.currentDetail.name," "]}),Object(m.jsxs)("p",{children:["Fecha de nacimiento: ",e.currentDetail.date_of_birth]}),Object(m.jsxs)("p",{children:["Email: ",e.currentDetail.email]})]}),Object(m.jsxs)("div",{children:[Object(m.jsx)("h3",{children:"Historia"}),Object(m.jsx)("div",{children:Object(m.jsxs)("form",{onSubmit:function(t){return e.onUpdateStatus(t,e.currentDetail.id,s)},children:[Object(m.jsxs)("select",{value:null===s?n:s,onChange:function(e){i(e.target.value)},children:[Object(m.jsx)("option",{value:"Nuevo",children:"Nuevo"}),Object(m.jsx)("option",{value:"En seguimiento",children:"En seguimiento"}),Object(m.jsx)("option",{value:"Atendido",children:"Atendido"}),Object(m.jsx)("option",{value:"Rechazado",children:"Rechazado"})]}),Object(m.jsx)("input",{type:"submit",value:"Actualizar status"})]})}),e.currentHistory.map((function(e){return console.log(e),Object(m.jsxs)("p",{children:[e.status," ",e.check_in_time]})}))]})]}):null};n(45);var v=function(e){return Object(m.jsx)("p",{className:"customer-item item",onClick:function(t){return e.getCustomerHistory(t,e.customer.id,e.customer)},children:e.customer.name})};n(46);var x=function(e){var t=Object(r.useState)([]),n=Object(u.a)(t,2),c=n[0],a=n[1],s=Object(r.useState)([]),i=Object(u.a)(s,2),j=i[0],d=i[1],h=Object(r.useState)({}),b=Object(u.a)(h,2),f=b[0],x=b[1],g=Object(r.useState)(""),k=Object(u.a)(g,2),y=k[0],w=k[1],S=Object(r.useState)(""),C=Object(u.a)(S,2),N=C[0],D=C[1],A=Object(r.useState)(""),T=Object(u.a)(A,2),z=T[0],H=T[1];Object(r.useEffect)((function(){(function(){var t=Object(l.a)(o.a.mark((function t(){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.getAllCustomerNames(e.token);case 2:n=t.sent,a(n);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[]);var F=function(){var t=Object(l.a)(o.a.mark((function t(n,r,c){var a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),t.next=3,p.getCustomerHistory(r,e.token);case 3:a=t.sent,d(a),x(c);case 6:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),E=function(){var t=Object(l.a)(o.a.mark((function t(n,r,c){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.preventDefault(),p.updateCustomerStatus(r,c,e.token);case 2:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}();return Object(m.jsxs)("div",{className:"main-page",children:[Object(m.jsxs)("div",{className:"customer-list-container",children:[Object(m.jsx)("div",{className:"new-customer-form",children:Object(m.jsxs)("form",{onSubmit:function(t){t.preventDefault(),p.createCustomer(y,N,z,e.token)},children:[Object(m.jsx)("h4",{children:"Agregar nuevo cliente"}),Object(m.jsx)("p",{children:"Nombre"}),Object(m.jsx)("input",{type:"text",onChange:function(e){w(e.target.value)}}),Object(m.jsx)("p",{children:"Fecha de nacimiento"}),Object(m.jsx)("input",{type:"date",onChange:function(e){H(e.target.value)}}),Object(m.jsx)("p",{children:"Email"}),Object(m.jsx)("input",{type:"email",onChange:function(e){D(e.target.value)}}),Object(m.jsx)("input",{type:"submit",value:"Save"})]})}),Object(m.jsxs)("div",{className:"customer-list-items",children:[Object(m.jsx)("h4",{className:"title-customer-list-items",children:"Lista de clientes"}),c.map((function(e){return Object(m.jsx)(v,{customer:e,getCustomerHistory:F})}))]}),Object(m.jsx)("button",{onClick:function(){sessionStorage.removeItem("token"),e.deleteToken()},children:"Log out"})]}),Object(m.jsx)("div",{children:Object(m.jsx)(O,{currentHistory:j,currentDetail:f,onUpdateStatus:E})})]})};n(47);var g=function(e){var t=Object(r.useState)(""),n=Object(u.a)(t,2),c=n[0],a=n[1],s=Object(r.useState)(""),i=Object(u.a)(s,2),o=i[0],l=i[1],j=function(t){sessionStorage.setItem("token",t),e.handleToken(t)};return Object(m.jsx)("div",{className:"login",children:Object(m.jsxs)("form",{onSubmit:function(e){e.preventDefault(),p.authenticate(c,o,j)},children:[Object(m.jsx)("div",{className:"item-login",children:Object(m.jsx)("h2",{children:"Log in"})}),Object(m.jsxs)("div",{className:"item-login",children:[Object(m.jsx)("p",{children:"User"}),Object(m.jsx)("input",{type:"text",value:c,onChange:function(e){a(e.target.value)}})]}),Object(m.jsxs)("div",{className:"item-login",children:[Object(m.jsx)("p",{children:"Password"}),Object(m.jsx)("input",{type:"password",value:o,onChange:function(e){l(e.target.value)}})]}),Object(m.jsx)("div",{className:"item-login",children:Object(m.jsx)("input",{type:"submit",value:"Login"})})]})})};n(48);var k=function(){var e=Object(r.useState)(sessionStorage.getItem("token")),t=Object(u.a)(e,2),n=t[0],c=t[1];return Object(m.jsxs)("div",{children:[Object(m.jsx)("header",{className:"app-header",children:Object(m.jsx)("h1",{children:"Banco Autofin"})}),Object(m.jsx)("div",{className:"content",children:null===n?Object(m.jsx)(g,{handleToken:function(e){c(e)}}):Object(m.jsx)(x,{deleteToken:function(){c(null)},token:n})})]})},y=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,50)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),r(e),c(e),a(e),s(e)}))};s.a.render(Object(m.jsx)(c.a.StrictMode,{children:Object(m.jsx)(k,{})}),document.getElementById("root")),y()}},[[49,1,2]]]);
//# sourceMappingURL=main.56bd33d0.chunk.js.map